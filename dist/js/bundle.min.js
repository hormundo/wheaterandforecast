const KEY="1dc82a28b0407cd1aab188ddebb887d6",URLBASE="https://api.openweathermap.org/data/2.5/forecast",citiesLocal=[];document.addEventListener("DOMContentLoaded",e=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(e){lat=e.coords.latitude,lon=e.coords.longitude,getCity(lat,lon,null)}),(function(e){console.log("Ubicación no activada")})),getCitiesMenu()});const getCitiesMenu=()=>{let e=document.querySelector(".cities-fav");for(;e.firstChild;)e.removeChild(e.firstChild);let t=localStorage.getItem("ciudades").split(","),n=t.filter((e,n)=>t.indexOf(e)===n);n.sort,n&&n.forEach(t=>{e.insertAdjacentHTML("afterbegin",`<div class="row px-4 mb-4">\n                <div class="col city-fav">\n                    ${t}\n                    <button class="btn btn-remove-fav rounded-circle d-flex justify-content-center align-items-center"><i class="fas fa-heart"></i></button>\n                </div>\n            </div>`)})},forecastCity=e=>{document.querySelector(".btn-type-term--c").style.display="flex",document.querySelector(".btn-type-term--f").style.display="flex";const t={dia:"",icon:"",desc:"",mintemp:"",maxtemp:""};document.querySelector(".forecasts").innerHTML="";const n=document.querySelector(".forecast-template").content,o=document.createDocumentFragment();for(let c=5;c<40;c+=8){let r=e.list[c].dt_txt.split(" ");t.dia=r[0],t.icon=e.list[c].weather[0].icon,t.desc=e.list[c].weather[0].description,t.mintemp=Math.round(e.list[c].main.temp_min),t.maxtemp=Math.round(e.list[c].main.temp_max),n.querySelector("h6").textContent=t.dia,n.querySelector(".current-wheater img").src=`./src/images/${t.icon}@2x.png`,n.querySelector(".description").textContent=t.desc,n.querySelector(".mintemp").textContent=t.mintemp,n.querySelector(".maxtemp").textContent=t.maxtemp,$clone=document.importNode(n,!0),o.appendChild($clone)}document.querySelector(".forecasts").appendChild(o)},hightlights=e=>{document.querySelector(".hightlights").style.display="grid",document.querySelector(".wind-status .wind-speed").textContent=e.list[0].wind.speed+" Kmh",document.querySelector(".wind-status .progress-humidity").style.width=e.list[0].main.humidity+"%",document.querySelector(".humidity-percent").textContent=e.list[0].main.humidity+" %",document.querySelector(".presure").textContent=e.list[0].main.pressure+" mb",document.querySelector(".sea-level").textContent=e.list[0].main.sea_level+" mts"};async function getCity(e,t,n,o){let c="";c=o?`${URLBASE}?q=${n}&lang=es&units=${o}&appid=${KEY}`:n?`${URLBASE}?q=${n}&lang=es&units=metric&appid=${KEY}`:`${URLBASE}?lat=${e}&lon=${t}&lang=es&units=metric&appid=${KEY}`;try{let e=await fetch(c),t=await e.json();document.querySelector(".current-wheater img").src=`./src/images/${t.list[0].weather[0].icon}@2x.png`,document.querySelector(".current-location").textContent=t.city.name,document.querySelector(".population").textContent=` ${t.city.population} Hab.`;let n=document.querySelector(".current-temperature");n.textContent=Math.round(t.list[0].main.temp);let o=document.createElement("SUB");o.classList.add("text-gray-semibold"),o.textContent="°C",document.querySelector(".current-phenomenom-atmospheric").textContent=t.list[0].weather[0].description;let r=moment.unix(t.city.sunset),i=r._d.getHours(),a=r._d.getHours(),s=moment.unix(t.city.sunrise),l=s._d.getHours(),u=s._d.getHours();document.querySelector(".sunrise").textContent=`${l<10?"0"+l:l}:${u<10?"0"+u:u}`,document.querySelector(".sunset").textContent=`${i<10?"0"+i:i}:${a<10?"0"+a:a}`,n.insertAdjacentElement("beforeend",o);let d,m=new Date;switch(m.getUTCDay()){case 1:d="Lunes";break;case 2:d="Martes";break;case 3:d="Miércoles";break;case 4:d="Jueves";break;case 5:d="Viernes";break;case 6:d="Sábado";break;case 0:d="Domingo"}if(document.querySelector(".date").textContent=`${d}, ${m.toLocaleDateString()}`,!e.ok)throw{status:e.status,statusText:e.statusText};document.querySelector(".current-temperature").style.display="block",document.querySelector(".current-location").style.display="block",document.querySelector(".sunrise").style.display="flex",document.querySelector(".sunset").style.display="flex",forecastCity(t),hightlights(t);const y=window.speechSynthesis,g=`En ${t.city.name} hace una temperatura de ${Math.round(t.list[0].main.temp)} grados, con ${t.list[0].weather[0].description}`,p=new SpeechSynthesisUtterance(g);y.speak(p)}catch(e){let t=e.statusText||"Ocurrio un error";document.querySelector(".content").insertAdjacentHTML("afterend",`<p><b>Error ${e.status} ${t}</b></p>`)}}document.addEventListener("click",e=>{if(e.target.matches(".btn-search-location")&&document.querySelector(".menu").classList.add("visible"),e.target.matches(".fa-times")&&document.querySelector(".menu").classList.remove("visible"),e.target.matches(".btn-current-location")&&navigator.geolocation.getCurrentPosition((function(e){lat=e.coords.latitude,lon=e.coords.longitude,getCity(lat,lon)})),e.target.matches(".btn-search")){let e=document.querySelector("input").value;document.querySelector(".menu").classList.remove("visible"),getCity(null,null,e,null)}if(e.target.matches(".btn-type-term--c")){city=document.querySelector(".current-location").textContent;let t="metric";e.target.classList.add("active"),document.querySelector(".btn-type-term--f").classList.remove("active"),getCity(null,null,city,t)}if(e.target.matches(".btn-type-term--f")){city=document.querySelector(".current-location").textContent;let t="imperial";e.target.classList.add("active"),document.querySelector(".btn-type-term--f").classList.remove("active"),getCity(null,null,city,t)}if(e.target.matches(".btn-fav")||e.target.matches(".btn-fav *")){if(city=document.querySelector(".current-location").textContent,localStorage.getItem("ciudades")){let e=localStorage.getItem("ciudades"),t=e.split(" ");e=[...t,city],localStorage.setItem("ciudades",e)}else localStorage.setItem("ciudades",city);getCitiesMenu()}if(e.target.matches(".btn-remove-fav")||e.target.matches(".btn-remove-fav *")){e.target.parentElement.textContent;if(localStorage.getItem("ciudades")){let e=localStorage.getItem("ciudades"),t=e.split(" ");e=[...t,city],localStorage.setItem("ciudades",e)}else localStorage.setItem("ciudades",city);getCitiesMenu()}e.target.matches(".city-fav")&&(city=e.target.textContent,document.querySelector(".menu").classList.remove("visible"),getCity(null,null,city,null))});
//# sourceMappingURL=bundle.js.map
